---
import Layout from '../layouts/Layout.astro';

// WICHTIG: News abfragen
const { sanityClient } = await import('sanity:client');

const latestPost = await sanityClient.fetch(`
  *[_type == "post" && defined(slug.current)] | order(publishedAt desc) [0] {
    title,
    slug,
    publishedAt,
    excerpt,
    "imageUrl": mainImage.asset->url
  }
`);

const formatDate = (dateString: string) => {
  return new Date(dateString).toLocaleDateString('de-DE', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
};
// ... (Restlicher Code bleibt gleich) ...
---

<Layout title="Stadtburschen Freising">
	<!-- ... HERO BANNER CODE VON VORHER ... -->
	
	<main class="max-w-6xl mx-auto px-4">

      {/* NEUE SEKTION: NEUESTE NEWS */}
      {latestPost && (
          <section class="py-16 md:py-24">
              <h2 class="text-3xl font-serif font-bold text-gray-900 dark:text-white mb-10 text-center">
                  Aktuelle Meldungen
              </h2>
              
              <a href={`/news/${latestPost.slug.current}`} class="block rounded-2xl overflow-hidden shadow-2xl transition-all duration-300 transform hover:scale-[1.01] bg-white dark:bg-[#111] group">
                  <div class="flex flex-col lg:flex-row">
                      
                      {/* Bild (50% Breite auf Desktop) */}
                      <div class="lg:w-1/2 aspect-video lg:aspect-auto bg-gray-200 dark:bg-gray-800">
                          {latestPost.imageUrl && (
                            <img 
                              src={`${latestPost.imageUrl}?w=800&h=500&fit=crop&q=80`} 
                              alt={latestPost.title}
                              class="w-full h-full object-cover transition-opacity duration-300 group-hover:opacity-85"
                            />
                          )}
                      </div>

                      {/* Text */}
                      <div class="lg:w-1/2 p-8 md:p-12 flex flex-col justify-center">
                          <p class="text-sm text-burschen-blau dark:text-burschen-gold uppercase font-bold mb-3 tracking-widest">
                            {formatDate(latestPost.publishedAt)}
                          </p>
                          <h3 class="text-3xl font-serif font-bold text-gray-900 dark:text-white mb-4">
                              {latestPost.title}
                          </h3>
                          <p class="text-gray-600 dark:text-gray-300 mb-6">
                              {latestPost.excerpt}
                          </p>
                          <span class="inline-flex items-center text-burschen-blau dark:text-burschen-gold font-bold">
                              Artikel lesen &rarr;
                          </span>
                      </div>
                  </div>
              </a>
          </section>
      )}
	  
	  </main>
</Layout>