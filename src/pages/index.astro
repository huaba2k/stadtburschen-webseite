---
import Layout from '../layouts/Layout.astro';

// WICHTIG: News und nur die Vorschau-Daten abfragen
const { sanityClient } = await import('sanity:client');

const latestPosts = await sanityClient.fetch(`
  *[_type == "post" && defined(slug.current)] | order(publishedAt desc) [0..2] { // Holen die 3 neuesten Posts
    title,
    slug,
    publishedAt,
    excerpt
  }
`);

const formatDate = (dateString: string) => {
  return new Date(dateString).toLocaleDateString('de-DE', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
};

// Hintergrundbild ist im Layout.astro definiert
---

<Layout title="Stadtburschen Freising - Willkommen">
	
	<!-- Hero Banner (Bleibt gleich, definiert im HTML-Teil von vorhin) -->
	<div class="flex flex-col justify-center items-center text-center px-4 min-h-[70vh] pt-20">
		
		<span class="text-burschen-gold font-bold tracking-[0.2em] uppercase text-sm mb-4 animate-pulse">
			Seit 1850 in Freising
		</span>

		<h1 class="font-serif text-5xl md:text-7xl lg:text-8xl font-bold text-gray-900 dark:text-white mb-6 leading-tight">
			Tradition.<br />
			<span class="text-burschen-blau dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-burschen-blau dark:to-blue-400">
				Freundschaft.
			</span>
		</h1>

		<p class="text-gray-700 dark:text-gray-300 text-lg md:text-xl max-w-2xl mb-10 leading-relaxed font-medium">
			Wir sind das älteste soziale Netzwerk der Stadt. Offline, echt und gesellig.
			Komm vorbei und erlebe Gemeinschaft neu.
		</p>

		<div class="flex flex-col md:flex-row gap-4 w-full md:w-auto">
			<a href="/termine" class="px-8 py-4 bg-burschen-gold text-burschen-DEFAULT font-bold rounded hover:bg-burschen-blau hover:text-white transition-colors duration-300 shadow-lg">
				Nächster Stammtisch
			</a>
			<a href="/kontakt" class="px-8 py-4 border-2 border-burschen-blau text-burschen-blau dark:border-white/30 dark:text-white rounded hover:bg-burschen-blau hover:text-white dark:hover:bg-white/10 dark:hover:border-white transition-all duration-300">
				Mitglied werden
			</a>
		</div>

	</div>
	
	<!-- Content Sektion unter dem Banner -->
	<section class="max-w-6xl mx-auto px-4 py-20 md:py-24">
		
		<div class="grid grid-cols-1 lg:grid-cols-3 lg:gap-12">
			
			<!-- Spalte 1: Willkommenstext (Nimmt 2/3 der Breite) -->
			<div class="lg:col-span-2 prose prose-lg dark:prose-invert max-w-none text-gray-800 dark:text-gray-200 mb-12 lg:mb-0">
				
				<h2>Servus und Herzlich Willkommen auf der Homepage des Stadtburschen-Verein Freising e. V.</h2>
				<p class="lead">
					Schön, dass Sie den Weg auf unsere Homepage gefunden haben.
				</p>
				<p>
					Gegründet im Jahr 1850, sind wir ein traditionsreicher Freisinger Verein, der die Geselligkeit und Kameradschaft pflegt.
				</p>
				<p>
					Unsere Gemeinschaft ist ein Ort der Begegnung und des Miteinanders. Hier blühen Freundschaften und Erinnerungen werden geschaffen. Wir laden alle Interessierten und neuen Mitglieder ein, sich unseren Zielen anzuschließen und Teil dieser lebendigen Gemeinschaft zu werden.
					<br>
					Gemeinsam ehren wir auch die verstorbenen Mitglieder, deren Geist und Erbe in unserem Verein weiterleben.
					<br>
					Treten Sie mit uns in Kontakt und freuen Sie sich auf gesellschaftliche Veranstaltungen, wie gemeinsame Ausflüge, Busreisen, Feiern wie Sommerfeste und Weihnachtsfeiern oder gemeinschaftliches Beisammensitzen mit informativen und anregenden Unterhaltungen.
					<br>
					Wir freuen uns, wenn der Verein seine lange Traditon weiter fortführen kann.
					<br>
					Ihr Stadtburschen-Verein Freising e. V.
					<br>
				</p>
				<a href="/ueber-uns" class="inline-block mt-4 text-burschen-blau dark:text-burschen-gold font-bold hover:underline">Mehr über uns erfahren Sie hier &rarr;</a>

			</div>
			
			<!-- Spalte 2: News und CTA (Nimmt 1/3 der Breite) -->
			<aside class="lg:col-span-1 space-y-8">

				<!-- 1. Aktuelle News -->
				<div class="bg-gray-50 dark:bg-[#111] p-6 rounded-xl shadow-md border border-gray-200 dark:border-white/5">
					<h3 class="text-xl font-serif font-bold text-gray-900 dark:text-white mb-4">
						Aktuelles
					</h3>
					
					{latestPosts.length > 0 ? (
						<ul class="space-y-4">
							{latestPosts.map((post: any) => (
								<li>
									<a href={`/news/${post.slug.current}`} class="group block">
										<p class="text-xs text-burschen-blau dark:text-burschen-gold uppercase font-bold mb-0">
											{formatDate(post.publishedAt)}
										</p>
										<p class="font-semibold text-gray-800 dark:text-gray-200 group-hover:text-burschen-blau dark:group-hover:text-burschen-gold transition-colors">
											{post.title}
										</p>
										<p class="text-xs text-gray-500 line-clamp-1">
											{post.excerpt}
										</p>
									</a>
								</li>
							))}
						</ul>
					) : (
						<p class="text-sm text-gray-500">Aktuell gibt es keine Meldungen.</p>
					)}
					
					<a href="/news" class="mt-4 text-sm font-bold text-burschen-blau dark:text-burschen-gold hover:underline block">
						Alle Neuigkeiten &rarr;
					</a>
				</div>

				<!-- 2. Nächster Termin CTA -->
				<div class="bg-burschen-blau dark:bg-burschen-gold p-6 rounded-xl shadow-lg">
					<p class="text-lg font-bold text-white dark:text-black mb-2">
						Wann treffen wir uns?
					</p>
					<p class="text-sm text-blue-100 dark:text-black/80 mb-4">
						Der schnellste Weg, uns kennenzulernen, ist bei einem unserer nächsten Termin.
					</p>
					<a href="/termine" class="w-full inline-block text-center py-2 bg-white/90 text-burschen-blau font-bold rounded hover:bg-white transition-colors dark:bg-black/80 dark:text-burschen-gold">
						Terminübersicht
					</a>
				</div>

			</aside>
		</div>

	</section>
</Layout>